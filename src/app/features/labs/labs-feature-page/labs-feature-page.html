<section class="page">
  @if (lab(); as selectedLab) {
    <app-lab-hero [lab]="selectedLab"></app-lab-hero>

    <div class="lab-body">
      <app-lab-toc [sections]="tocSections()"></app-lab-toc>

      <div class="lab-content">
        @for (section of sections(); track section.id) {
          <app-lab-section [section]="section"></app-lab-section>
        }

        @if (selectedLab.id === 'signals') {
          <app-lab-code-demo
            sectionId="demo"
            demoId="signals-quick-compare"
            title="Signals quick compare demo"
            description="Pick up to three Pokemon and see derived state update instantly."
            [tabs]="signalsDemoTabs"
          >
            <app-signals-demo labDemoPreview></app-signals-demo>
          </app-lab-code-demo>
        }

        @if (selectedLab.id === 'httpresource') {
          <app-lab-code-demo
            sectionId="demo"
            demoId="httpresource-lookup"
            title="httpResource lookup demo"
            description="Fetch a Pokemon by name and track loading and error states."
            [tabs]="httpResourceDemoTabs"
          >
            <app-httpresource-demo labDemoPreview></app-httpresource-demo>
          </app-lab-code-demo>
        }

        <app-lab-exercise sectionId="exercise" [exercise]="selectedLab.exercise"></app-lab-exercise>
        <app-lab-references sectionId="references" [references]="selectedLab.references"></app-lab-references>
      </div>
    </div>
  } @else {
    <header class="page-header" appTextureLayer>
      <div>
        <p class="eyebrow">Lab</p>
        <h1>Content pending</h1>
      </div>
    </header>

    <div class="placeholder" appTextureLayer>
      @if (catalogItem(); as item) {
        <p class="placeholder-title">{{ item.title }}</p>
        <p>{{ item.summary }}</p>
      } @else {
        <p>This lab is not available yet.</p>
      }
    </div>
  }
</section>
