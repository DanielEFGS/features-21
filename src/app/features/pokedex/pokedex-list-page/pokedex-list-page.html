<section class="page">
  <header class="page-header" appTextureLayer>
    <div>
      <p class="eyebrow" i18n="@@pokedexListEyebrow">Pokedex</p>
      <h1 i18n="@@pokedexListTitle">List</h1>
    </div>
    <p class="hint" i18n="@@pokedexListHint">Base v1: list, pagination, sorting, and simple filters.</p>
  </header>

  <section class="controls" appTextureLayer>
    <label class="field">
      <span i18n="@@pokedexListSearchLabel">Search</span>
      <div class="field-control">
        <input
          type="search"
          [value]="query()"
          placeholder="Pokemon name"
          i18n-placeholder="@@pokedexListSearchPlaceholder"
          class="ui-input"
          (input)="updateQuery($any($event.target).value)"
        />
      </div>
    </label>
    <label class="field" for="type-select">
      <span i18n="@@pokedexListTypeLabel">Type</span>
      <div class="field-control">
        <select
          #typeSelect
          id="type-select"
          class="ui-select-native"
          [value]="typeFilter()"
          (change)="updateType($any($event.target).value)"
        >
          <option value="" i18n="@@pokedexListTypeAll">All types</option>
          @if (typesState().status === 'loading') {
            <option disabled i18n="@@pokedexListTypeLoading">Loading...</option>
          } @else if (typesState().status === 'error') {
            <option disabled i18n="@@pokedexListTypeError">Unavailable</option>
          } @else {
            @for (type of typesState().items; track type.name) {
              <option [value]="type.name">{{ type.name }}</option>
            }
          }
        </select>
      </div>
    </label>
    <label class="field" for="sort-select">
      <span i18n="@@pokedexListOrderLabel">Order</span>
      <div class="field-control">
        <select
          #sortSelect
          id="sort-select"
          class="ui-select-native"
          [value]="sortBy()"
          (change)="updateSort($any($event.target).value)"
        >
          @for (option of sortOptions; track option.value) {
            <option [value]="option.value">{{ option.label }}</option>
          }
        </select>
      </div>
    </label>
    <label class="field" for="dir-select">
      <span i18n="@@pokedexListDirLabel">Direction</span>
      <div class="field-control">
        <select
          #dirSelect
          id="dir-select"
          class="ui-select-native"
          [value]="sortDir()"
          (change)="updateDir($any($event.target).value)"
        >
          @for (option of dirOptions; track option.value) {
            <option [value]="option.value">{{ option.label }}</option>
          }
        </select>
      </div>
    </label>
  </section>

  @if (listState().status === 'loading') {
    <div class="skeleton-grid">
      @for (_ of [1,2,3,4,5,6,7,8]; track $index) {
        <div class="skeleton-card"></div>
      }
    </div>
  } @else if (listState().status === 'error') {
    <div class="placeholder" appTextureLayer>
      <p>{{ listState().error }}</p>
      <button class="button ghost" type="button" (click)="retryLoad()" i18n="@@pokedexListRetry">Retry</button>
    </div>
  } @else if (listState().status === 'empty') {
    <div class="placeholder" appTextureLayer>
      <p i18n="@@pokedexListEmpty">No results to display.</p>
    </div>
  } @else {
    <div class="list-grid">
      @for (item of listState().items; track item.id) {
        <a
          class="card"
          [routerLink]="['/pokedex', item.id]"
          [attr.aria-label]="'View details for ' + item.name"
          i18n-attr.aria-label="@@pokedexListCardAria"
        >
          <div class="card-body">
            <div class="thumb">
              @if (item.spriteUrl || item.artworkUrl) {
                <img
                  [src]="item.spriteUrl ?? item.artworkUrl"
                  [alt]="item.name"
                />
              } @else {
                <span class="thumb-fallback" i18n="@@pokedexListNoImage">No image</span>
              }
            </div>
            <div>
              <p class="name">{{ item.name }}</p>
              <p class="meta">ID: {{ item.id }}</p>
              <div class="chip-row">
                @for (type of item.types; track type.name) {
                  <span class="chip">{{ type.name }}</span>
                }
              </div>
            </div>
          </div>
        </a>
      }
    </div>
  }

  <div class="pager">
    <button class="button ghost" type="button" (click)="goToPreviousPage()" [disabled]="!canPrev()" i18n="@@pokedexListPrev">
      Previous
    </button>
    <span class="pager-status" i18n="@@pokedexListPager">Page {{ page() }} of {{ totalPages() }}</span>
    <button class="button ghost" type="button" (click)="goToNextPage()" [disabled]="!canNext()" i18n="@@pokedexListNext">
      Next
    </button>
  </div>
</section>
